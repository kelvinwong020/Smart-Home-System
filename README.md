# Smart-Home-System
HKUST ELEC 3300 Project
### YouTube Demo
<p><a href="https://youtu.be/idSp3R__D4U">
<img src="/assets/img/smart_home_thumbnail.png">
</a></p>

![Smart Home System](/assets/img/smart_home.jpg)
![System Diagram](/assets/img/smart_home_overview.png)

# Description
In this project, we built an IOT(Internet Of Things) system that utilizes STM32F103 development boards to control an array of sensors and devices. This systems contains 4 major components: room monitoring, automatic brightness control, automatic temperature control, and control over WLAN. The project aims to provide a suite of centralized electronic devices that can improve the quality of life within a household. Originally, the system was intended to have a door lock control system and a mobile application for remote control. But due to budget and time constraints, these components was reduced to room monitoring and web server instead.

The technology used for this project are: C, I2C, UART, SPI, GPIO, STLink, STM32

IDE Utilized: Keli V5, STM32CubeMX

# Room Monitoring
For security/monitoring purposes, we included an OV7725 camera that gives live feed of the environment being monitored. The OV7725 camera contains a CMOS that captures the image data and feeds it to a FIFO buffer. The STM32 borad than reads from the FIFO and displays the data on a resistive touch screen(XPT2046).
<br>![OV7725](/assets/img/ov7725.png)
![monitor](/assets/img/room_monitoring.png)

To facilitate an easy-to-use interface, we have included an touch screen that allows users to control the functionality of the board. XPT2046 is controlled using SPI. The X and Y coordinates of each touch is obtained by detecting the voltage of the ITO layer and translating the information with ADC. The X and Y coordiantes of touch are then used to determine which subroutines to trigger.
<br>![Touch1](/assets/img/touch_screen1.png)
![Touch2](/assets/img/touch_screen2.png)

# Automatic Brightness Control
A photoresistor was used to provide the brightness of the room. The duty cycle of the PWM signal used to power the lights are adjusted accordingly to the brightness of the room. The darker than room is, the brighter the lights become. The idea was to provide a comfortable lighting at all times.
<br>![Bright0](/assets/img/touch_screen1.png)
![Bright1](/assets/img/brightness1.png)
![Bright2](/assets/img/brightness3.png)

# Automatic Temperature Control
In order to moderate the temperatue of the room, an temperature control system was included. The temperature and humidity of the room is collected with a climate sensor(DHT11). The STM32 board can then adjust the fan speed by adjusting the duty cycle of the PWM signal sent to the fan according to different thresholds. The PWM signal generated by the STM32 board is not powerful enough. Thus, it must be pulled up to 5V before it can be detected by the fan.
The fan speed can either be automatically or manually controlled.
<br>![Fan](/assets/img/fan_auto.png)

# Web Server / WLAN Control
Interacting with STM32 board directly, even with the touch screen, can be annoying and inconvenient. Therefore, a web server was implemented, so that users can interact with system using their own devices(PC/Mobile) over WLAN. This achieved by hosting a HTML server at port 80 with a ESP8266. The ESP8266 communicates with the STM32 via a ring buffer.
The result is that users can control the smart home system from anywhere with in the house and receive updates from it.<br>
![WebServer](/assets/img/web_server.png)
